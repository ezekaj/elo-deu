
> dental-calendar@1.0.0 start
> node server.js

[dotenv@17.2.1] injecting env (9) from .env -- tip: üîê prevent committing .env to code: https://dotenvx.com/precommit
Socket.IO server initialized
Datenbank bereit - Kalender startet mit leerer Termindatenbank
Dental Calendar Server running on http://localhost:3005
Sofia Webhook: POST /api/sofia/appointment
LiveKit WebSocket Proxy: ws://localhost:3005/livekit-proxy
Client connected: Qji2Pwf69Dr7S4DsAAAC
Client disconnected: Qji2Pwf69Dr7S4DsAAAC
Client connected: A6T4ikJ0vvUSRqDYAAAE
Client disconnected: A6T4ikJ0vvUSRqDYAAAE
Client connected: jZZaZj7PtoMW0ByhAAAG
üéüÔ∏è Generating LiveKit token for Calendar User 1754050246803 in room sofia-dental-1754050246803
üì° Using LiveKit URL: ws://localhost:7880
üîÑ New WebSocket proxy connection to LiveKit
Request URL: /livekit-proxy/rtc?access_token=eyJhbGciOiJIUzI1NiJ9.eyJ2aWRlbyI6eyJyb29tSm9pbiI6dHJ1ZSwicm9vbSI6InNvZmlhLWRlbnRhbC0xNzU0MDUwMjQ2ODAzIiwiY2FuUHVibGlzaCI6dHJ1ZSwiY2FuU3Vic2NyaWJlIjp0cnVlLCJjYW5QdWJsaXNoRGF0YSI6dHJ1ZX0sIm1ldGFkYXRhIjoie1wicmVxdWVzdF9hZ2VudFwiOnRydWUsXCJhZ2VudF90eXBlXCI6XCJkZW50YWwtYXNzaXN0YW50XCJ9IiwiaXNzIjoiZGV2a2V5IiwiZXhwIjoxNzU0MDg2MjQ2LCJuYmYiOjAsInN1YiI6IkNhbGVuZGFyIFVzZXIgMTc1NDA1MDI0NjgwMyJ9._QAvlK86O7JscSl_VA37xvwGmIuUfwM3LCOBg5MCriU&auto_subscribe=1&sdk=js&version=1.15.4&protocol=11&adaptive_stream=1
Request headers: {
  host: 'e13f48333e1e.ngrok-free.app',
  'user-agent': 'Mozilla/5.0 (iPhone; CPU iPhone OS 18_5 like Mac OS X) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/18.5 Mobile/15E148 Safari/604.1',
  accept: '*/*',
  'accept-encoding': 'gzip, deflate, br',
  'accept-language': 'en-US,en;q=0.9',
  'cache-control': 'no-cache',
  connection: 'Upgrade',
  origin: 'https://elosofia.site',
  pragma: 'no-cache',
  priority: 'u=3, i',
  'sec-fetch-dest': 'websocket',
  'sec-fetch-mode': 'websocket',
  'sec-fetch-site': 'cross-site',
  'sec-websocket-extensions': 'permessage-deflate',
  'sec-websocket-key': 'WYFzcov5KtaNAmXHoC+NOw==',
  'sec-websocket-version': '13',
  upgrade: 'websocket',
  'x-forwarded-for': '153.92.90.3',
  'x-forwarded-host': 'e13f48333e1e.ngrok-free.app',
  'x-forwarded-proto': 'https'
}
Target URL: ws://localhost:7880/rtc?access_token=eyJhbGciOiJIUzI1NiJ9.eyJ2aWRlbyI6eyJyb29tSm9pbiI6dHJ1ZSwicm9vbSI6InNvZmlhLWRlbnRhbC0xNzU0MDUwMjQ2ODAzIiwiY2FuUHVibGlzaCI6dHJ1ZSwiY2FuU3Vic2NyaWJlIjp0cnVlLCJjYW5QdWJsaXNoRGF0YSI6dHJ1ZX0sIm1ldGFkYXRhIjoie1wicmVxdWVzdF9hZ2VudFwiOnRydWUsXCJhZ2VudF90eXBlXCI6XCJkZW50YWwtYXNzaXN0YW50XCJ9IiwiaXNzIjoiZGV2a2V5IiwiZXhwIjoxNzU0MDg2MjQ2LCJuYmYiOjAsInN1YiI6IkNhbGVuZGFyIFVzZXIgMTc1NDA1MDI0NjgwMyJ9._QAvlK86O7JscSl_VA37xvwGmIuUfwM3LCOBg5MCriU&auto_subscribe=1&sdk=js&version=1.15.4&protocol=11&adaptive_stream=1
Headers: {
  "host": "e13f48333e1e.ngrok-free.app",
  "user-agent": "Mozilla/5.0 (iPhone; CPU iPhone OS 18_5 like Mac OS X) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/18.5 Mobile/15E148 Safari/604.1",
  "accept": "*/*",
  "accept-encoding": "gzip, deflate, br",
  "accept-language": "en-US,en;q=0.9",
  "cache-control": "no-cache",
  "connection": "Upgrade",
  "origin": "https://elosofia.site",
  "pragma": "no-cache",
  "priority": "u=3, i",
  "sec-fetch-dest": "websocket",
  "sec-fetch-mode": "websocket",
  "sec-fetch-site": "cross-site",
  "sec-websocket-extensions": "permessage-deflate",
  "sec-websocket-key": "WYFzcov5KtaNAmXHoC+NOw==",
  "sec-websocket-version": "13",
  "upgrade": "websocket",
  "x-forwarded-for": "153.92.90.3",
  "x-forwarded-host": "e13f48333e1e.ngrok-free.app",
  "x-forwarded-proto": "https"
}
LiveKit WS error: Error: Unexpected server response: 401
    at ClientRequest.<anonymous> (/home/elo/elo-deu/dental-calendar/node_modules/ws/lib/websocket.js:913:7)
    at ClientRequest.emit (node:events:517:28)
    at HTTPParser.parserOnIncomingClient (node:_http_client:700:27)
    at HTTPParser.parserOnHeadersComplete (node:_http_common:119:17)
    at Socket.socketOnData (node:_http_client:541:22)
    at Socket.emit (node:events:517:28)
    at addChunk (node:internal/streams/readable:368:12)
    at readableAddChunk (node:internal/streams/readable:341:9)
    at Readable.push (node:internal/streams/readable:278:10)
    at TCP.onStreamRead (node:internal/stream_base_commons:190:23)
LiveKit disconnected: 1006 <Buffer >
Client disconnected: 1001 <Buffer 4c 69 76 65 4b 69 74 20 63 6f 6e 6e 65 63 74 69 6f 6e 20 66 61 69 6c 65 64>
Client disconnected: jZZaZj7PtoMW0ByhAAAG
Client connected: XCUe25LTki7B-V7RAAAI
Client disconnected: XCUe25LTki7B-V7RAAAI
Client connected: bIGlbNGadv3FbyXmAAAK
Client disconnected: bIGlbNGadv3FbyXmAAAK
Client connected: 0B9dHn3RpuSuyYm3AAAM
üéüÔ∏è Generating LiveKit token for Calendar User 1754050417862 in room sofia-dental-1754050417862
üì° Using LiveKit URL: ws://localhost:7880
üîÑ New WebSocket proxy connection to LiveKit
Request URL: /livekit-proxy/rtc?access_token=eyJhbGciOiJIUzI1NiJ9.eyJ2aWRlbyI6eyJyb29tSm9pbiI6dHJ1ZSwicm9vbSI6InNvZmlhLWRlbnRhbC0xNzU0MDUwNDE3ODYyIiwiY2FuUHVibGlzaCI6dHJ1ZSwiY2FuU3Vic2NyaWJlIjp0cnVlLCJjYW5QdWJsaXNoRGF0YSI6dHJ1ZX0sIm1ldGFkYXRhIjoie1wicmVxdWVzdF9hZ2VudFwiOnRydWUsXCJhZ2VudF90eXBlXCI6XCJkZW50YWwtYXNzaXN0YW50XCJ9IiwiaXNzIjoiZGV2a2V5IiwiZXhwIjoxNzU0MDg2NDE4LCJuYmYiOjAsInN1YiI6IkNhbGVuZGFyIFVzZXIgMTc1NDA1MDQxNzg2MiJ9.3RjsMetoLZdq0IbesU22RzJZKuy1x3g2HNNr3uw0Wrc&auto_subscribe=1&sdk=js&version=1.15.4&protocol=11&adaptive_stream=1
Request headers: {
  host: 'e13f48333e1e.ngrok-free.app',
  'user-agent': 'Mozilla/5.0 (iPhone; CPU iPhone OS 18_5 like Mac OS X) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/18.5 Mobile/15E148 Safari/604.1',
  accept: '*/*',
  'accept-encoding': 'gzip, deflate, br',
  'accept-language': 'en-US,en;q=0.9',
  'cache-control': 'no-cache',
  connection: 'Upgrade',
  origin: 'https://elosofia.site',
  pragma: 'no-cache',
  priority: 'u=3, i',
  'sec-fetch-dest': 'websocket',
  'sec-fetch-mode': 'websocket',
  'sec-fetch-site': 'cross-site',
  'sec-websocket-extensions': 'permessage-deflate',
  'sec-websocket-key': '1AJ/KY992tk/aoFWu4eYHQ==',
  'sec-websocket-version': '13',
  upgrade: 'websocket',
  'x-forwarded-for': '153.92.90.3',
  'x-forwarded-host': 'e13f48333e1e.ngrok-free.app',
  'x-forwarded-proto': 'https'
}
Target URL: ws://localhost:7880/rtc?access_token=eyJhbGciOiJIUzI1NiJ9.eyJ2aWRlbyI6eyJyb29tSm9pbiI6dHJ1ZSwicm9vbSI6InNvZmlhLWRlbnRhbC0xNzU0MDUwNDE3ODYyIiwiY2FuUHVibGlzaCI6dHJ1ZSwiY2FuU3Vic2NyaWJlIjp0cnVlLCJjYW5QdWJsaXNoRGF0YSI6dHJ1ZX0sIm1ldGFkYXRhIjoie1wicmVxdWVzdF9hZ2VudFwiOnRydWUsXCJhZ2VudF90eXBlXCI6XCJkZW50YWwtYXNzaXN0YW50XCJ9IiwiaXNzIjoiZGV2a2V5IiwiZXhwIjoxNzU0MDg2NDE4LCJuYmYiOjAsInN1YiI6IkNhbGVuZGFyIFVzZXIgMTc1NDA1MDQxNzg2MiJ9.3RjsMetoLZdq0IbesU22RzJZKuy1x3g2HNNr3uw0Wrc&auto_subscribe=1&sdk=js&version=1.15.4&protocol=11&adaptive_stream=1
Headers: {
  "host": "e13f48333e1e.ngrok-free.app",
  "user-agent": "Mozilla/5.0 (iPhone; CPU iPhone OS 18_5 like Mac OS X) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/18.5 Mobile/15E148 Safari/604.1",
  "accept": "*/*",
  "accept-encoding": "gzip, deflate, br",
  "accept-language": "en-US,en;q=0.9",
  "cache-control": "no-cache",
  "connection": "Upgrade",
  "origin": "https://elosofia.site",
  "pragma": "no-cache",
  "priority": "u=3, i",
  "sec-fetch-dest": "websocket",
  "sec-fetch-mode": "websocket",
  "sec-fetch-site": "cross-site",
  "sec-websocket-extensions": "permessage-deflate",
  "sec-websocket-key": "1AJ/KY992tk/aoFWu4eYHQ==",
  "sec-websocket-version": "13",
  "upgrade": "websocket",
  "x-forwarded-for": "153.92.90.3",
  "x-forwarded-host": "e13f48333e1e.ngrok-free.app",
  "x-forwarded-proto": "https"
}
LiveKit WS error: Error: Unexpected server response: 401
    at ClientRequest.<anonymous> (/home/elo/elo-deu/dental-calendar/node_modules/ws/lib/websocket.js:913:7)
    at ClientRequest.emit (node:events:517:28)
    at HTTPParser.parserOnIncomingClient (node:_http_client:700:27)
    at HTTPParser.parserOnHeadersComplete (node:_http_common:119:17)
    at Socket.socketOnData (node:_http_client:541:22)
    at Socket.emit (node:events:517:28)
    at addChunk (node:internal/streams/readable:368:12)
    at readableAddChunk (node:internal/streams/readable:341:9)
    at Readable.push (node:internal/streams/readable:278:10)
    at TCP.onStreamRead (node:internal/stream_base_commons:190:23)
LiveKit disconnected: 1006 <Buffer >
Client disconnected: 1001 <Buffer 4c 69 76 65 4b 69 74 20 63 6f 6e 6e 65 63 74 69 6f 6e 20 66 61 69 6c 65 64>
Client disconnected: 0B9dHn3RpuSuyYm3AAAM
Client connected: YndWljM4A2ZJLek5AAAO
Client disconnected: YndWljM4A2ZJLek5AAAO
Client connected: Q6wnX877OIFu_DCiAAAQ
Client disconnected: Q6wnX877OIFu_DCiAAAQ
